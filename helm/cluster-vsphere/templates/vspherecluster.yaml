apiVersion: {{ include "infrastructureApiVersion" . }}
kind: VSphereCluster
metadata:
  name: {{ include "resource.default.name" $ }}
  namespace: {{ .Release.Namespace }}
  labels:
    {{- include "labels.common" . | nindent 4 }}
spec:
  controlPlaneEndpoint:
    host: '{{ ((.Values.network).controlPlaneEndpoint).host }}'
    port: {{ ((.Values.network).controlPlaneEndpoint).port | default 6443 }}

  identityRef:
    # kind is either Secret or VSphereClusterIdentity. 
    # Secret needs to be in the same namespace as this VSphereCluster.
    # VSphereClusterIdentity is a cluster-wide CR.
    kind: VSphereClusterIdentity
    name: {{ .Release.Namespace }}-{{ include "resource.default.name" $ }}
  server: {{ .Values.vcenter.server }}
  thumbprint: {{ .Values.vcenter.thumbprint }}
